tdir := "target/thumbv6m-none-eabi/debug"
app := "jolt-embassy-rp"

build:
	cargo build --bin {{app}}

serve:
	JLinkGDBServer  \
		-if swd \
		-speed auto \
		-device RP2040_M0_0 \
		-endian little \
		-nogui

rtt:
	defmt-print \
		--log-format "{t} [{L}]: {s}" \
		-e {{tdir}}/{{app}} \
		-w \
		tcp

uf2:
	elf2uf2-rs target/thumbv6m-none-eabi/debug/jolt-embassy-rp main.uf2
	echo "Put keyboard into UF2 mode. Waiting 5 seconds"
	sleep 5
	echo Flashing
	cp main.uf2 /Volumes/RPI-RP2

gdb:
	arm-none-eabi-gdb {{tdir}}/{{app}}
# -rtos /Applications/SEGGER/JLink_V812c/GDBServer/RTOSPlugin_Zephyr \
# -rtttelnetport 19021
# -select usb \
# -port 2331 \
